import asyncio
import websockets
import time

async def hello(websocket, path):
    print(path)
    print("连接成功马上打印")                    #这里会在client开始连接时就调用
    name = await websocket.recv()       #这里会挺住,等待client发送消息
    print(f"< {name}")

    greeting = f"Hello {name}!"
    a = b'\x10\x94\x01\x18\x01*\xda\x04\n\x0e\x08\xc0\xe1\x823\x12\x07success\x12\n30013332122l\x18\x06 \x03(\xd0\xc0\xd6\x8d\xcf\xad\x0b@\xe8\x9f\x94\xfe\xc9\xb0\x0bH\x80\x85\xd1\x99\x94\xac\x0bP\xe8\x9f\x94\xfe\xc9\xb0\x0bX\xe8\xe0\xad\xcb\xa0\xac\x0b`\xe8\xa5\x93\xa9\x99\xa9\x0b\xd0\x01\x80\xbb\x9a\xa2\x87\x03\xe0\x01\xe8\x9a\xc3\xe4\xb5\x04\xe8\x01\xb0\x97\xd4\xa5\xcf\x03\xb8\x02\xd0\xc0\xd6\x8d\xcf\xad\x0b\xc0\x02\xd0\xfb\xf0\xaf\xd6\xb0\x0b\xc8\x02\xd0\xfb\xf0\xaf\xd6\xb0\x0b\xd8\x02\xc0\x84=:\x16\n\n3001333212\x18\x06 \x07\xd8\x02\xd0\xde\xcc\x02:\x16\n\n3001333212\x18\x06 \x08\xd8\x02\xbc\xc4\xe2\x02:\x16\n\n3001333212\x18\x06 \t\xd8\x02\xd0\xce\xdf\x03:\x15\n\n3001333212\x18\x06 \n\xd8\x02\xf0\xc3D:\x16\n\n3001333212\x18\x06 \x04\xd8\x02\xb8\x92\x97\x04:\x16\n\n3001333212\x18\x06 \x05\xd8\x02\xbc\xa8\xdd\x04:x\n\n3001333212\x18\x06 \x03(\xa0\x98\xa3\xc3\xce\xad\x0b@\xa0\x9d\x92\xe8\xbf\xb0\x0bH\xe0\x80\xa5\xed\xeb\xac\x0bP\xa0\x9d\x92\xe8\xbf\xb0\x0bX\xe0\xb6\xd0\xea\x81\xad\x0b`\xe0\xfb\xb5\xc8\xfa\xa9\x0b\xd0\x01\x80\xbb\x9a\xa2\x87\x03\xe0\x01\xc0\x9c\xed\xfa\xd3\x03\xe8\x01\x80\xf6\xa8\xae\xf6\x02\xb8\x02\xa0\x98\xa3\xc3\xce\xad\x0b\xc0\x02\xa0\xd3\xbd\xe5\xd5\xb0\x0b\xc8\x02\xa0\xd3\xbd\xe5\xd5\xb0\x0b\xd8\x02\xc0\x84=:\x15\n\n3001333212\x18\x06 \x06\xd8\x02\xa0\xb6\x04:\x15\n\n3001333212\x18\x06 \x0b\xd8\x02\xe8\xc1r:\x16\n\n3001333212\x18\x06 \x0c\xd8\x02\xbc\x88\xdd\x02:\x15\n\n3001333212\x18\x06 \r\xd8\x02\xac\x9b\x0f:h\n\n3001333212\x18\x06 \x02(\x80\xda\xc4\t@\x80\xa7\xf2\xa6\x01H\x80\xfc\xed\xe1\xf4\xff\xff\xff\xff\x01P\x80\xa7\xf2\xa6\x01X\x80\xaf\xc0\xc4\xf3\xff\xff\xff\xff\x01`\x80\xaf\xc0\xc4\xf3\xff\xff\xff\xff\x01\xe0\x01\x80\xab\x84\xc5\x0c\xe8\x01\x80\xca\x8f\xb3\x0b\xb8\x02\x80\xda\xc4\t\xc0\x02\x80\xda\xc4\t\xc8\x02\x80\xda\xc4\t\xd8\x02\x9c\x95\xdc\x03'
    await websocket.send(a)
    print(f"> {greeting}")

start_server = websockets.serve(hello, 'localhost', 8766)

asyncio.get_event_loop().run_until_complete(start_server)   #先执行这里
asyncio.get_event_loop().run_forever()                      #在这里停住,等待